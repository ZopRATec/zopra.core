<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      i18n:domain="zopra">

  <body>
    <tal:comment tal:replace="nothing">

    </tal:comment>
    
<metal:block define-macro="multiconfirm_listing">
    <!-- Multiconfirmation of Working Copies (Listing) -->
    <tal:block tal:define="reviewers rev_roles|string:ZopRAReviewer;"
               tal:condition="python: user.has_role(reviewers, here)">
      <h1 i18n:translate="">Freigabe</h1>
      <div tal:repeat="table python:manager.tableHandler.keys()">
        <tal:block tal:define="tobj python: manager.tableHandler[table]"
                   tal:condition="python: manager.doesWorkingCopies(table)">
          <div tal:define="entries python: manager.getWorkingCopies(table)"
               tal:condition="entries">
            
            <h2 tal:content="python: tobj.getLabel()"></h2>
			<a tal:attributes="href python: manager.absolute_url() + '/zopra_table_multiconfirm_form?table=' + table"><span style="color: red">*NEU*</span>Mehrfachfreigabe</a>
            <table id="result_tab">
              <tr>
                <th>Name</th>
                <th>Diff</th>
                <th>Freigabe</th>
              </tr>
              <tr tal:repeat="entry entries">
                <td tal:content="python: manager.getLabelString(table, None, entry)"></td>
                <td>
                  <tal:block content="python: ', '.join(manager.getDiffLabels(table, entry))">
                  </tal:block>
                  <a tal:attributes="href python: manager.absolute_url() + '/zopra_manager_show_log?entryid=%s&table=%s' % (entry['autoid'], table)">(Details)</a>
                </td>
                <td>
                  <a tal:attributes="href python: manager.absolute_url() + '/zopra_table_edit_form?autoid=%s&table=%s' % (entry['autoid'], table)">&raquo;zur Freigabe</a>
                </td>
              </tr>
            </table>
          </div>
        </tal:block>
      </div>
    </tal:block>
</metal:block>
  </body>
</html>