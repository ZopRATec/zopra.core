<tal:comment tal:replace="nothing">

</tal:comment>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="zopra">

  <body>

    <metal:css_slot fill-slot="css_slot">
       <link rel="stylesheet" type="text/css" media="all"  tal:attributes="href string:${portal_url}/zopra.css" />
       <link rel="stylesheet" type="text/css" media="all"  tal:attributes="href string:${portal_url}/zopra_edit.css" />
    </metal:css_slot>
    <metal:css_slot fill-slot="style_slot">
       <link rel="stylesheet" type="text/css" media="all"  tal:attributes="href string:${portal_url}/zopra.css" />
       <link rel="stylesheet" type="text/css" media="all"  tal:attributes="href string:${portal_url}/zopra_edit.css" />
    </metal:css_slot>

    <metal:topslot fill-slot="top_slot">
       <tal:block tal:define="
                 global toLocalizedTime nocall:context/@@plone/toLocalizedTime;
                 global portal_properties context/portal_properties;
                 global site_properties context/portal_properties/site_properties;
                 global portal context/@@plone_portal_state/portal;
                 global isAnon context/@@plone_portal_state/anonymous;
                 global member context/@@plone_portal_state/member;
                 global mtool context/portal_membership;
                 global wtool context/portal_workflow;
                 global wf_state context/@@plone_context_state/workflow_state;
                 global default_language context/@@plone_portal_state/default_language;
       ">
       </tal:block>
     </metal:topslot>

    <metal:main fill-slot="main">

      <tal:block tal:condition="isAnon">
        <tal:block replace="context/raiseUnauthorized"></tal:block>
      </tal:block>

      <tal:block tal:define="targetname python: 'zopra_manager_main_form_' + here.getClassName()"
                 tal:condition="exists: here/?targetname">
        <div tal:define="dummy python: request.RESPONSE.redirect(targetname)" />
      </tal:block>

      <h1 i18n:translate="">Manager Overview</h1>
      <div tal:define="tables python:here.tableHandler.keys();">
          <div tal:repeat="table tables" tal:omit-tag="">
            <tal:block tal:condition="python: here.getGenericConfig(table).get('visible', True)" tal:define="tobj python:here.tableHandler[table];">

              <fieldset class="" title=""
                        tal:define="icon_url here/iconHandler/absolute_url;
                                    link_url python:here.absolute_url()+'/zopra_table_action_selector?table=%s' % table;">
                <legend class="" tal:content="python: tobj.getLabel()">Tablename</legend>
                  <form class="" method="post" action=""
                        tal:attributes="action python:here.absolute_url()+'/zopra_table_action_selector'">

                <table border="0">
                <tr><td>
                  <a class=""
                     title="Neuen Eintrag anlegen"
                     tal:define="name python:'f_'+table+'_intern_create';"
                     tal:attributes="href python: link_url + '&' + name + '=create'">
                    <img class="action_image" width="92" height="50" alt="Anlegen"
                       tal:attributes="src python:icon_url + '/ziCreate.png'" />
                  </a>
                </td><td>
                  <a class=""
                     title="Einträge suchen"
                     tal:define="name python:'f_'+table+'_intern_search';"
                     tal:attributes="href python: link_url + '&' + name + '=search'">
                    <img class="action_image" width="50" height="50" alt="Suchen"
                       tal:attributes="src python:icon_url + '/ziSearch.png'" />
                  </a>
                </td><td>
                  <a class=""
                     title="Alle Einträge anzeigen"
                     tal:define="name python:'f_'+table+'_intern_list';"
                     tal:attributes="href python: link_url + '&' + name + '=list'">
                    <img class="action_image" width="51" height="50" alt="Auflisten"
                       tal:attributes="src python:icon_url + '/ziList.png'" />
                  </a>
                </td></tr>
                <tr><td>
                  <span class="" title="">Neu</span>
                </td><td>
                  <span class="" title="">Suchen</span>
                </td><td>
                  <span class="" title="">Liste</span>
                </td></tr></table>

              </form>
            </fieldset>
          </tal:block>
        </div>
      </div>
      <div tal:define="lists python:here.listHandler.keys();
                       permission python: here.getPermissionInfo('', 'list_edit')"
           tal:condition="permission">
        <fieldset class="" title="" tal:define="global foundone python:False;">
          <legend class="">Editierbare Auswahllisten</legend>

          <tal:block tal:repeat="listname lists">
            <div class="field"
                 tal:define="lobj python:here.listHandler[listname]"
                 tal:condition="python:lobj.noedit != True">
              <a tal:define="global foundone python: foundone or not lobj.noedit;"
                 href=""
                 tal:attributes="href python:here.absolute_url()+'/zopra_list_edit_form?listname=' + listname;" tal:content="python: lobj.getLabel()">
                Listname
              </a>
            </div>
          </tal:block>
          <div tal:condition="python: not foundone">
            Keine editierbaren Listen gefunden.
          </div>
        </fieldset>
      </div>
    </metal:main>

    <metal:column_two_slot fill-slot="column_two_slot">
      <tal:block tal:condition="context/isOldPlone">
        <metal:block metal:use-macro="here/zopra_context_menu/macros/context_menu" />
      </tal:block>
    </metal:column_two_slot>

    <metal:bottom fill-slot="bottom">
      <metal:block metal:use-macro="here/zopra_bottom/macros/bottom" />
    </metal:bottom>

  </body>

</html>
