<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"
      i18n:domain="plone">

<body>
<tal:comment tal:replace="nothing">
unused special display for search pages with reduced functionality (only single select). OBSOLETE!
</tal:comment>

<metal:widget_selector define-macro="widget_selector">
  <metal:block metal:use-macro="python:path('here/zopra_widget_search_display/macros/widget_'+attr_type)" />
</metal:widget_selector>

<metal:widget_string define-macro="widget_string">
  <input type="text"
         size="40"
         tal:attributes="value attr_value; name attr_name; id attr_name"
    />
</metal:widget_string>

<metal:widget_int define-macro="widget_int">
  <input type="text"
         size="40"
         tal:attributes="value attr_value; name attr_name; id attr_name"
    />
</metal:widget_int>

<metal:widget_float define-macro="widget_float">
  <input type="text"
         size="40"
         tal:attributes="value attr_value; name attr_name; id attr_name"
    />
</metal:widget_float>

<metal:widget_currency define-macro="widget_currency">
  <input type="text"
         size="40"
         tal:attributes="value python: ('%.2f' % attr_value).replace('.', ',');
                         name attr_name; id attr_name"
    />
</metal:widget_currency>

<metal:widget_date define-macro="widget_date">
  <input type="text"
         size="40"
         tal:attributes="value attr_value; name attr_name; id attr_name"
    />
</metal:widget_date>

<metal:widget_bool define-macro="widget_bool">
  <input type="checkbox"
         value="1"
         tal:attributes="checked python:bool(attr_value) and attr_value != '0'; name attr_name; id attr_name"
    />
</metal:widget_bool>

<metal:widget_memo define-macro="widget_memo">
  <input type="text"
         size="40"
         tal:attributes="value attr_value; name attr_name; id attr_name"
    />
</metal:widget_memo>

<metal:widget_singlelist define-macro="widget_singlelist" tal:define="style widget_style | string:'list'">
  <tal:block tal:condition="python:style!='force_single'">
    <select tal:define="lobj python:here.listHandler.getList(table, attr_name);
                        entries python:lobj.getEntries();
                        do_sort attr_sort|nothing;
                        dummy python: do_sort and entries.sort(key=lambda item: item['value']);"
            tal:attributes="name attr_name; id attr_name;"
            class="single">
        <option value="">-auswaehlen-</option>
      <tal:block tal:repeat="entry entries">
        <option tal:attributes="value python: str(entry['autoid']); selected python:str(entry['autoid']) == str(attr_value);"
                tal:content="python:entry['value']">
          value
        </option>
      </tal:block>
    </select>
  </tal:block>
  <tal:block tal:condition="python:style=='force_single'">
    <select tal:define="lobj python:here.listHandler.getList(table, attr_name);
                        entries python:lobj.getEntries();
                        do_sort attr_sort|nothing;
                        dummy python: do_sort and entries.sort(key=lambda item: item['value']);"
            tal:attributes="name python:attr_name + ':list'; id attr_name;">
        <option value="">-auswaehlen-</option>
      <tal:block tal:repeat="entry entries">
        <option tal:attributes="value python: str(entry['autoid']); selected python: len(attr_value) > 0 and str(entry['autoid']) == str(attr_value[0]);"
                tal:content="python:entry['value']">
          value
        </option>
      </tal:block>
    </select>
  </tal:block>
</metal:widget_singlelist>

<metal:widget_multilist define-macro="widget_multilist">
<tal:block tal:define="lobj python:here.listHandler.getList(table, attr_name);
                       entries python:lobj.getEntries();
                       do_sort attr_sort|nothing;
                       dummy python: do_sort and entries.sort(key=lambda item: item['value']);
                       notes python: lobj.notes;
                       tmp_store python: {};">
<table class="multiselect"><tr><td>
  <select size="5" multiple
          tal:attributes="name python:attr_name+':list'; id attr_name;">
    <tal:block tal:repeat="entry entries">
      <option tal:define="bla python: tmp_store.update([[entry['autoid'], entry['value']]])"
              tal:attributes="value python: str(entry['autoid']); selected python:str(entry['autoid']) in [str(val) for val in attr_value];"
              tal:content="python:entry['value']">
        value
      </option>
    </tal:block>
  </select>
</td></tr></table>
</tal:block>
</metal:widget_multilist>

</body>
</html>
